
{% extends 'base.html' %}


    {% block content %}

    <!-- {% load static %}
    -->

    </style>
<div class="tradingview-widget-container">
  <div class="tradingview-widget-container__widget"></div>
  <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>
  {
  "symbols": [
    {
      "proName": "FOREXCOM:SPXUSD",
      "title": "S&P 500"
    },
    {
      "proName": "FOREXCOM:NSXUSD",
      "title": "Nasdaq 100"
    },
    {
      "proName": "FX_IDC:EURUSD",
      "title": "EUR/USD"
    },
    {
      "proName": "BITSTAMP:BTCUSD",
      "title": "BTC/USD"
    },
    {
      "description": "TSLA",
      "proName": "NASDAQ:TSLA"
    },
    {
      "description": "AAPL",
      "proName": "NASDAQ:AAPL"
    },
    {
      "description": "QQQ",
      "proName": "NASDAQ:QQQ"
    },
    {
      "description": "FB",
      "proName": "NASDAQ:FB"
    },
    {
      "description": "GOOG",
      "proName": "NASDAQ:GOOG"
    }
  ],
  "showSymbolLogo": true,
  "colorTheme": "dark",
  "isTransparent": false,
  "displayMode": "adaptive",
  "locale": "en"
}
  </script>
</div>
<!-- TradingView Widget END -->

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarNavAltMarkup"
        aria-controls="navbarNavAltMarkup"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav">
          <a class="nav-item nav-link" style="font-size: 1.5em" href="/"
            >Home</a
          >

          <a class="nav-item nav-link" style="font-size: 1.5em" href="/about"
            >About</a
          >
          <a class="nav-item nav-link" style="font-size: 1.5em" href="/contact"
            >Contact</a
          >
        </div>
      </div>
    </nav>

{% load static %}


<p class="popout" style="text-align: center;" >

<span>P</span>
<span>O</span>
<span>R</span>
<span>T</span>
<span>F</span>
<span>O</span>
<span>L</span>
<span>I</span>
<span>O</span>

</p>



<center>
  <div id="container" style="width: 1000px; height: 800px;">
    <div class="row">
        <div class="col align-self-center">
          {% load static %}
      <script src="{% static 'js/portfolio.min.js' %}" type="text/javascript"></script>
      
            <script>
  anychart.onDocumentLoad(function () {
    // create an instance of a pie chart
    var chart = anychart.pie();
    // set the data
    lis = document.querySelectorAll('li')
    chart.data([
      [lis[0].textContent, 5],
      [lis[1].textContent, 2],
      [lis[2].textContent, 2],
      [lis[3].textContent, 2],
      [lis[4].textContent, 1]
    ]);
    // set chart title
  
    // set the container element
    chart.container("container");
    // initiate chart display
    chart.draw();
  });
  </script>
  
  
    </div>
  
  </div>
  
  </div>
  </center>

  
<!--    <h2 class="text-center text-primary">Portfolio based on {{ object.stock_name }} stock with a {{ object.risk_level}} risk</h2>-->
<!--<img src="{% static 'images/portfolio.png' %}">-->
<!--<img src="{% static 'images/graph.png' %}">-->
<p id = 'stock' style="display: none">{{ obj.stock_name }}</p>
<p id = 'chart_type' style="display: none;">{{graph}}</p>

{% for ticker in tickers%}
    <li style="display: none">{{ ticker }}</li>
{% endfor%}

<ul>
{% for prices in prices%}
    <li style="display: none;">{{ price }}</li>
{% endfor%}
</ul>

<br><br><br>
<!-- <h2 style="display: none;">{{obj.stock_name}} Chart</h2> -->

<p id = "sentiaverage" style="display: none;" >{{senti}}</p>

<p class="popout1" style="text-align: center;" >

  <span>Sentiment Analysis for {{ obj.stock_name }}</span>

  
  </p>
 
  <div class="row justify-content-end">
 
  <div class="col-4">
<!-- <div class=""> -->
  <canvas id="foo" width="500" height="300"></canvas>
 <!-- </div> -->
</div>
 
 <div class="col-4">
 <!-- <center> -->
 <div class="legend">
   <p><span class="green"></span>Strong Buy</p>
   <p><span class="yellow"></span>Buy    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
   <p><span class="orange"></span>Sell  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
   <p><span class="red"></span>Strong Sell</p>
 </div>
 <!-- <center> -->
</div>
</div>
<p class="text-center">The sentiment is based on NLP Sentiment Analysis from Yahoo Finance Conversation Section. </p>
  <script src = "https://cdnjs.cloudflare.com/ajax/libs/gauge.js/1.3.7/gauge.js"></script>
  <!-- <script src="app.js"></script> -->
  <script>var opts = {
      angle: 0, // The span of the gauge arc
      lineWidth: 0.3, // The line thickness
      radiusScale: 0.9, // Relative radius
      pointer: {
        length: 0.42, // // Relative to gauge radius
        strokeWidth: 0.029, // The thickness
        color: '#000000' // Fill color
      },
      limitMax: true,     // If false, max value increases automatically if value > maxValue
      limitMin: true,     // If true, the min value of the gauge will be fixed
      colorStart: '#6F6EA0',   // Colors
      colorStop: '#C0C0DB',    // just experiment with them
      strokeColor: '#EEEEEE',  // to see which ones work best for you
      generateGradient: true,
      highDpiSupport: true,     // High resolution support
      // renderTicks is Optional
      // renderTicks: {
      //   divisions: 0,
      //   divWidth: 0.1,
      //   divLength: 0.41,
      //   divColor: '#333333',
      //   subDivisions: 0,
      //   subLength: 0.14,
      //   subWidth: 3.1,
      //   subColor: '#ffffff'
      // },
      staticZones: [
       {strokeStyle: "#F03E3E", min: -10, max: -5}, // Red from 70 to 80
       {strokeStyle: "orange", min: -5, max: 0}, // Yellow 80 to 90
       {strokeStyle: "#FFDD00", min: 0, max: 5}, // Green 90 to 100
        {strokeStyle: "#30B32D", min: 5, max: 10}, // Green 90 to 100
      ],
      staticLabels: {
      font: "10px sans-serif",  // Specifies font
      labels: [-10,-5,0,5,10],  // Print labels at these values
      color: "#000000",  // Optional: Label text color
      fractionDigits: 0  // Optional: Numerical precision. 0=round off.
    },
      
    };
    var target = document.getElementById('foo'); // your canvas element
    let senti_score = document.getElementById('sentiaverage').innerHTML;
    var gauge = new Gauge(target).setOptions(opts); // create sexy gauge!
    gauge.maxValue = 10; // set max gauge value
    gauge.setMinValue(-10);  // Prefer setter over gauge.minValue = 0
    gauge.animationSpeed = 10; // set animation speed (32 is default value)
    gauge.set(senti_score); // set actual value
    </script>


<p id = "sentinews" style="display: none;">{{senti_news}}</p>


<p class="popout2" style="text-align: center;" >

  <span>Sentiment Analysis for the General Market</span>

  
  </p>
 
  <div class="row justify-content-end">
 
  <div class="col-4">
<!-- <div class=""> -->
  <canvas id="foo1" width="500" height="300"></canvas>
 <!-- </div> -->
</div>
 
 <div class="col-4">
 <!-- <center> -->
 <div class="legend">
   <p><span class="green"></span>Strong Buy</p>
   <p><span class="yellow"></span>Buy    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
   <p><span class="orange"></span>Sell  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
   <p><span class="red"></span>Strong Sell</p>
 </div>
 <!-- <center> -->
</div>
</div>
<p class="text-center">The sentiment is based on NLP Sentiment Analysis from Yahoo Finance News. </p>
  <script src = "https://cdnjs.cloudflare.com/ajax/libs/gauge.js/1.3.7/gauge.js"></script>
  <!-- <script src="app.js"></script> -->
  <script>var opts = {
      angle: 0, // The span of the gauge arc
      lineWidth: 0.3, // The line thickness
      radiusScale: 0.9, // Relative radius
      pointer: {
        length: 0.42, // // Relative to gauge radius
        strokeWidth: 0.029, // The thickness
        color: '#000000' // Fill color
      },
      limitMax: true,     // If false, max value increases automatically if value > maxValue
      limitMin: true,     // If true, the min value of the gauge will be fixed
      colorStart: '#6F6EA0',   // Colors
      colorStop: '#C0C0DB',    // just experiment with them
      strokeColor: '#EEEEEE',  // to see which ones work best for you
      generateGradient: true,
      highDpiSupport: true,     // High resolution support
      // renderTicks is Optional
      // renderTicks: {
      //   divisions: 0,
      //   divWidth: 0.1,
      //   divLength: 0.41,
      //   divColor: '#333333',
      //   subDivisions: 0,
      //   subLength: 0.14,
      //   subWidth: 3.1,
      //   subColor: '#ffffff'
      // },
      staticZones: [
       {strokeStyle: "#F03E3E", min: -10, max: -5}, // Red from 70 to 80
       {strokeStyle: "orange", min: -5, max: 0}, // Yellow 80 to 90
       {strokeStyle: "#FFDD00", min: 0, max: 5}, // Green 90 to 100
        {strokeStyle: "#30B32D", min: 5, max: 10}, // Green 90 to 100
      ],
      staticLabels: {
      font: "10px sans-serif",  // Specifies font
      labels: [-10,-5,0,5,10],  // Print labels at these values
      color: "#000000",  // Optional: Label text color
      fractionDigits: 0  // Optional: Numerical precision. 0=round off.
    },
      
    };
    var target = document.getElementById('foo1'); // your canvas element
    let senti_news_score = document.getElementById('sentinews').innerHTML;
    var gauge = new Gauge(target).setOptions(opts); // create sexy gauge!
    gauge.maxValue = 10; // set max gauge value
    gauge.setMinValue(-10);  // Prefer setter over gauge.minValue = 0
    gauge.animationSpeed = 10; // set animation speed (32 is default value)
    gauge.set(senti_news_score); // set actual value
    </script>




<div class="wrap">
  <div class="search">

     <input id = "howudoin" type="text" class="searchTerm" placeholder="How do you feel about this stock?">
     <button type="submit" class="searchButton" onclick="getInputValue();">
       <i class="fa fa-search"></i>
    </button>
    

  </div>
 <p id="output"></p>
</div>


<script>


function getInputValue(){
            // Selecting the input element and get its value 
     var inputVal = document.getElementById("howudoin").value;
     var score = 0
     var output = document.getElementById('output');    
            // Displaying the value
            let access_token = "eyJraWQiOiI1RDVOdFM1UHJBajVlSlVOK1RraXVEZE15WWVMMFJQZ3RaUDJGTlhESHpzPSIsImFsZyI6IlJTMjU2In0.eyJjdXN0b206Y291bnRyeSI6IkNBIiwic3ViIjoiZjY5M2YyMGItYmY2Yi00OTc3LWFjYWMtMGM3YjVmMjhhOGVjIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImN1c3RvbTpwZXJzb25hbGl6YXRpb25BdXRoIjoiMSIsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0xX0FVSGdRMDhDQiIsInBob25lX251bWJlcl92ZXJpZmllZCI6ZmFsc2UsImNvZ25pdG86dXNlcm5hbWUiOiJmNjkzZjIwYi1iZjZiLTQ5NzctYWNhYy0wYzdiNWYyOGE4ZWMiLCJjdXN0b206Y29tcGFueSI6IlN0dWRlbnQiLCJhdWQiOiIxZWdzNjNxOTlwM3NlYmVjaHNiNzI5dDgwbyIsImV2ZW50X2lkIjoiMDBjMWE3NGYtYmZjMS00MjA2LTg0ZjEtYmIzZDliZjdhYmM2IiwidG9rZW5fdXNlIjoiaWQiLCJhdXRoX3RpbWUiOjE2MjMxNzE2MjksIm5hbWUiOiJNYWFuIiwicGhvbmVfbnVtYmVyIjoiKzE0MTY4ODkxNDE4IiwiZXhwIjoxNjI0NDE2ODY4LCJpYXQiOjE2MjQzMzA0NjgsImZhbWlseV9uYW1lIjoiUGF0ZWwiLCJlbWFpbCI6InBhdGVsLm1hYW4xNEBnbWFpbC5jb20iLCJjdXN0b206bWFya2V0aW5nQXV0aCI6IjEifQ.S0RZ2Hx10-Mm7FhezaygSq4iql8wsOLGVdUx2jKsb6_2cQYfJJEZWAVjvX-S2aCV5-ldzVeFD8RRt8abajz2iwSA3kqgeqhI3vVylZ7gK-S5tVuTyMMr6sNghui6p_0ISwcKkCLPH-8JjXm4y4nBHoQ2hHnou9icATMJq8oDIORQeZY1A_kPXTad_HZWBGFWr1A4bZJx9o2G46bS6ugdsYVDtaPx_ZhyUubwM6QmzQBVA8mjFeW9ReTizDCLFI_K6S4nvE1_PZVxnc96SVmvcixxD4JGP6Gk6rwnHsu7Y9jtT-Is23e7ouOvI2wljTAvnTFO0gLOy5EkMlErQEGfzQ"

      let request = new XMLHttpRequest();
      request.responseType = "json";
      request.open('POST', "https://nlapi.expert.ai/v2/analyze/standard/en/sentiment");
      request.setRequestHeader('Authorization', 'Bearer ' + access_token);
      request.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
      request.onload = function () {
          // do something to response
          /* var type = XMLHttpRequest.responseType */
          score = request.response.data.sentiment.overall;
          console.log(request.response.data.sentiment.overall);
          if (score < 0) {
        output.innerHTML = "It seems that you are not in favor of the stock. I will give you a bearish sentiment of Sell. &#128550;"
      }
      else if (score > 0){
        output.innerHTML = "It seems that you are in favor of the stock. I will give you a Bullish Sentiment of Buy! &#128516;"
      }
      else {
        output.innerHTML = "Hmm.. I'm not sure about that. You don't seem to support nor go against the stock. &#129300;"
      }
      };
      request.send(JSON.stringify({
        "document": {
          "text": document.getElementById("howudoin").value
        }
      }));
      score = request.response.data.sentiment.overall;
      }
      

      
</script>
<br><br><br>
<h2 style="display: none;">{{obj.stock_name}} Chart</h2>

<p class="popout" style="text-align: center;" >

  <span>Stock Chart</span>

  
  </p>

<script language="javascript" type="text/javascript">
  let stock_name = document.querySelectorAll('.stock');
  let links = document.getElementById('dynamicLink');
  l = links[0];
  l.innerHTML = `https://www.tradingview.com/symbols/${stock_name}/`
  return l
  </script>

<div class="tradingview-widget-container">
  <div id="tradingview_b0d5f"></div>

  <div class="tradingview-widget-copyright"><a id = "dynamicLink" href='link' rel="noopener" target="_blank"><span class="blue-text"></span></a></div>
  <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
  <script type="text/javascript">
  let stock_name = document.getElementById('stock').innerHTML;
  let graph_type = document.getElementById('chart_type').innerHTML;
  // console.log(stock_name)
  new TradingView.widget(
  {
  "width": 980,
  "height": 610,
  "symbol": stock_name,
  "interval": "D",
  "timezone": "Etc/UTC",
  "theme": "light",
  "style": graph_type,
  "locale": "en",
  "toolbar_bg": "#f1f3f6",
  "enable_publishing": false,
  "allow_symbol_change": true,
  "container_id": "tradingview_b0d5f"
}
  );
  </script>

<script type="text/javascript">
  let stock_name = document.getElementById('stock').innerHTML;
  console.log(stock_name)
</script>



  

</div>

<br><br><br>
<p class="popout" style="text-align: center;" >

  <span>Market Overview</span>

  
  </p>
<center>
 <!-- TradingView Widget BEGIN -->
 <div class="tradingview-widget-container">
  <div class="tradingview-widget-container__widget"></div>

  <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-screener.js" async>
  {
  "width": 1100,
  "height": 512,
  "defaultColumn": "overview",
  "defaultScreen": "most_capitalized",
  "market": "america",
  "showToolbar": true,
  "colorTheme": "light",
  "locale": "en"
}
  </script>
</div>
</center>
<!-- TradingView Widget END -->

<br>
<br>
<br>
<br>
<!-- <h2 class="text-success">The recommended portfolio for you is:</h2> -->



{% endblock %}


